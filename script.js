
    const recommendations = [
      {
        id: 1,
        axisLabel: "Axis 1 · Governance",
        shortTag: "Joint Committee",
        title: "Joint Student–Faculty Innovation Committee",
        metaLine: "A structured, recurring space where students and professors co-shape the programme.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Governance & dialogue",
          quote: "In our classes, we often make instructional decisions with the best of intentions, but without always knowing how they are actually perceived by students. Having a structured space where their perspectives can be heard on a regular basis would help us better align our choices with their needs. This kind of dialogue would promote mutual understanding and strengthen the coherence of the programme, without adding to anyone’s workload."
        },
        student: {
          name: "Student",
          role: "Student voice · Everyday experience",
          quote: "Often, we do not know how pedagogical decisions are made, or even why certain changes occur. A shared discussion space would finally give us the chance to be heard and to explain what we experience on a daily basis. It would create a climate of trust where everyone would feel more responsible and more committed to improving the programme."
        }
      },
      {
        id: 2,
        axisLabel: "Axis 1 · Governance",
        shortTag: "Quality Guide",
        title: "Common Pedagogical Quality Guide",
        metaLine: "A shared reference to align expectations while preserving teaching freedom.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Coherence & freedom",
          quote: "We know that each lecturer has his or her own way of organising a course, which is part of the richness of our faculty. However, students sometimes perceive these variations as inconsistencies rather than differences in style. A common quality guide would provide a clear and useful frame of reference for clarifying expectations, without limiting our pedagogical freedom."
        },
        student: {
          name: "Student",
          role: "Student voice · Navigating differences",
          quote: "For us, the differences between sections can be really destabilising, expectations, formats of lesson plans, platforms. A common guide would create coherence, reassure us, and help us better understand what we need to accomplish. We would feel more supported, especially in the first year, when everything is already new and often confusing."
        }
      },
      {
        id: 3,
        axisLabel: "Axis 2 · Teaching Support",
        shortTag: "Teaching Excellence",
        title: "Teaching Excellence Programme",
        metaLine: "A structured path to share, refine, and recognise pedagogical practice.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Professional development",
          quote: "Over the years, we have noticed that students learn differently and that some pedagogical approaches work better than others depending on the context. Having opportunities to discuss these practices and discover new methods would allow us to adjust what we do with greater precision. This would foster teaching that is even more attentive to students’ needs, while respecting the diversity of our styles."
        },
        student: {
          name: "Student",
          role: "Student voice · Learning impact",
          quote: "As students, you can tell immediately when a course is clearly structured and when the explanations genuinely guide you through the material. In some classes, you quickly understand where you are heading; in others, you remain a little lost even when you make the effort. When the pedagogical approach is well adapted, it completely changes our ability to follow, participate, and stay motivated."
        }
      },
      {
        id: 4,
        axisLabel: "Axis 2 · Teaching Support",
        shortTag: "Telfer Education Forum",
        title: "Telfer Education Forum",
        metaLine: "An ongoing space where instructors share challenges and ideas informally.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Community of practice",
          quote: "We all have our own methods and ways of approaching a subject, and it is important to preserve this freedom. But sometimes we wonder how our colleagues address certain challenges or manage to engage their groups. Having a space to discuss these issues informally would help us better understand one another’s approaches and, at times, generate ideas we would not have come up with alone."
        },
        student: {
          name: "Student",
          role: "Student voice · Coherent experience",
          quote: "You can clearly see that each lecturer has a unique style, and we appreciate that, but sometimes the differences are so great that it is difficult to make connections from one course to another. When lecturers collaborate, it shows immediately. The courses complement one another better, the messages are more coherent, and you can sense a shared direction. Knowing that teachers have a place to exchange ideas would be reassuring."
        }
      },
      {
        id: 5,
        axisLabel: "Axis 3 · Pedagogical Relationship",
        shortTag: "Reinventing the Classroom",
        title: "Reinventing the Classroom",
        metaLine: "From slide-based lectures to interactive spaces for active learning.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Active learning",
          quote: "Students today learn differently, they want to participate, question, and get involved. Rethinking our courses by incorporating more interactivity would not only capture their attention, but also lead to deeper learning. We can maintain rigour while making the learning experience livelier and more connected to their reality."
        },
        student: {
          name: "Student",
          role: "Student voice · Desire for interaction",
          quote: "What we want is a class where we do more than look at slides. When we discuss, analyse cases, or work in small groups, we retain much more and feel motivated. It is not that we reject lectures, we simply want to learn actively, through real dialogue."
        }
      },
      {
        id: 6,
        axisLabel: "Axis 3 · Pedagogical Relationship",
        shortTag: "Continuous Feedback",
        title: "Continuous Feedback",
        metaLine: "Feedback loops during the semester, not just at the end.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Adaptive teaching",
          quote: "End-of-term evaluations provide a good overview, but they arrive too late to help students currently in the course. I often think how useful it would have been to receive that kind of feedback earlier, so that I could adjust my pace or clarify certain points. Simple and regular feedback would allow quicker and more helpful adjustments for everyone."
        },
        student: {
          name: "Student",
          role: "Student voice · Being heard in time",
          quote: "In many classes, we wish we could have given our opinion earlier, because some adjustments would really have made a difference for us. We are not trying to criticise for the sake of it, we just want the course to evolve while we are actually taking it. When feedback is possible along the way, you feel that your experience genuinely matters."
        }
      },
      {
        id: 7,
        axisLabel: "Axis 4 · Student Experience",
        shortTag: "Integration Course",
        title: "Integration Course: “Living and Learning at Telfer”",
        metaLine: "A structured onboarding to academic life, expectations, and tools.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Setting the foundation",
          quote: "Students arrive with very different backgrounds, and sometimes lack the foundations needed to succeed in a demanding university environment. An integration course would give them essential points of reference, such as methodology, time management, and academic engagement. It is a way of giving them a solid start and building coherence from the first week."
        },
        student: {
          name: "Student",
          role: "Student voice · First-year transition",
          quote: "In the first year, we often feel lost, everything is new and no one really explains how the university works. An onboarding course would help us understand expectations, manage our workload better, and develop the confidence needed to succeed. It would greatly reduce stress and the feeling of isolation."
        }
      },
      {
        id: 8,
        axisLabel: "Axis 4 · Student Experience",
        shortTag: "Telfer Essentials",
        title: "Telfer Essentials Platform",
        metaLine: "One central entry point for resources, clubs, and support.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Digital coherence",
          quote: "A great deal of effort is made to make resources accessible, but I understand that the proliferation of platforms and channels can make things difficult for students. A clear entry point that brings together the essentials, especially at the start of the programme, would be extremely helpful. A central structure would make orientation easier for students and benefit the entire community."
        },
        student: {
          name: "Student",
          role: "Student voice · Discoverability & access",
          quote: "Many of us discovered clubs, services, or even study tools only at the end of the first year or later. It is not that they do not exist, we just come across them by chance. We often think that if we had known these things earlier, we would have experienced our first year very differently. Everything is there, but nothing is really organised or easy to find when you need it."
        }
      },
      {
        id: 9,
        axisLabel: "Axis 5 · AI & Integrity",
        shortTag: "AI Use Policy",
        title: "Responsible AI Use Policy",
        metaLine: "Clear, coherent rules for using AI as a learning tool.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Framing AI responsibly",
          quote: "AI is now part of students’ daily lives, and it would be unrealistic to pretend otherwise. What we truly need is a clear and coherent framework that supports responsible use. By setting out what is permitted and what is not, we avoid ambiguity, prevent misuse, and can focus on effective teaching in a context where these tools are already present."
        },
        student: {
          name: "Student",
          role: "Student voice · Clarity & confidence",
          quote: "AI can genuinely help us, but we are never entirely sure what is allowed and what is not, and this grey area creates a lot of hesitation. Sometimes we do not even dare to use a tool that could be useful, for fear of crossing a boundary without realising it. Clear and accessible rules would help us learn to use AI properly, without stress and in line with academic expectations."
        }
      },
      {
        id: 10,
        axisLabel: "Axis 5 · AI & Integrity",
        shortTag: "Integrity Pact",
        title: "Enhanced Integrity Pact",
        metaLine: "From sanctions to shared responsibility and dialogue.",
        professor: {
          name: "Professor",
          role: "Faculty voice · Beyond sanctions",
          quote: "I often notice that students are not lacking in goodwill, but that they sometimes feel uncertain about what is acceptable and what is not. For me, integrity should not be reduced to a system of sanctions, it is something built through dialogue and clarity. By creating a climate of trust where everyone understands the purpose of the rules, we encourage genuine responsibility, not simple compliance."
        },
        student: {
          name: "Student",
          role: "Student voice · Learning to act ethically",
          quote: "Most of us want to meet expectations, but it is not always easy to know where the limits are, especially with AI evolving so quickly. Having spaces to discuss these issues, ask questions, and understand the reason behind the rules would really help us act more thoughtfully. You learn better when you feel you can be honest without being judged."
        }
      }
    ];

    const chapterList = document.getElementById("chapterList");
    const playerEpisode = document.getElementById("playerEpisode");
    const playerTitle = document.getElementById("playerTitle");
    const playerMetaLine = document.getElementById("playerMetaLine");
    const speakerName = document.getElementById("speakerName");
    const speakerRole = document.getElementById("speakerRole");
    const speakerQuote = document.getElementById("speakerQuote");
    const profTab = document.getElementById("profTab");
    const stuTab = document.getElementById("stuTab");
    const playButton = document.getElementById("playButton");
    const timelineFill = document.getElementById("timelineFill");
    const timelineLabelLeft = document.getElementById("timelineLabelLeft");
    const timelineLabelRight = document.getElementById("timelineLabelRight");

    let currentId = 1;
    let currentSpeaker = "professor";
    let playTimer = null;
    let isPlaying = false;

    function renderChapterButtons() {
      recommendations.forEach(rec => {
        const btn = document.createElement("button");
        btn.className = "chapter-btn";
        btn.dataset.id = rec.id;
        btn.innerHTML = `
          <span class="chapter-label">${rec.axisLabel}</span>
          <span class="chapter-name">${rec.title}</span>
          <span class="chapter-tag">${rec.shortTag}</span>
        `;
        btn.addEventListener("click", () => {
          setCurrentRecommendation(rec.id);
        });
        chapterList.appendChild(btn);
      });
      updateActiveChapterButton();
    }

    function updateActiveChapterButton() {
      const buttons = chapterList.querySelectorAll(".chapter-btn");
      buttons.forEach(btn => {
        if (parseInt(btn.dataset.id, 10) === currentId) {
          btn.classList.add("active");
        } else {
          btn.classList.remove("active");
        }
      });
    }

    function setCurrentRecommendation(id) {
      const rec = recommendations.find(r => r.id === id);
      if (!rec) return;
      currentId = id;
      currentSpeaker = "professor";
      stopPlayback();

      playerEpisode.textContent =
        "EP" + String(rec.id).padStart(2, "0") + " · " + rec.axisLabel;
      playerTitle.textContent = rec.title;
      playerMetaLine.textContent = rec.metaLine;

      profTab.classList.add("active");
      stuTab.classList.remove("active");
      timelineFill.style.width = "0%";
      timelineLabelLeft.textContent = "Professor";
      timelineLabelRight.textContent = "Student";

      updateSpeakerDisplay();
      updateActiveChapterButton();
    }

    function updateSpeakerDisplay() {
      const rec = recommendations.find(r => r.id === currentId);
      if (!rec) return;

      if (currentSpeaker === "professor") {
        speakerName.textContent = rec.professor.name;
        speakerRole.textContent = rec.professor.role;
        speakerQuote.innerHTML = '<span class="quote-mark">“</span>' + rec.professor.quote;
        profTab.classList.add("active");
        stuTab.classList.remove("active");
        timelineFill.style.width = "20%";
      } else {
        speakerName.textContent = rec.student.name;
        speakerRole.textContent = rec.student.role;
        speakerQuote.innerHTML = '<span class="quote-mark">“</span>' + rec.student.quote;
        stuTab.classList.add("active");
        profTab.classList.remove("active");
        timelineFill.style.width = "100%";
      }
    }

    function stopPlayback() {
      isPlaying = false;
      playButton.classList.remove("active");
      playButton.innerHTML =
        '<svg viewBox="0 0 20 20" aria-hidden="true"><path fill="currentColor" d="M4 3.5v13l11.5-6.5L4 3.5z"/></svg>Play conversation';
      if (playTimer) {
        clearTimeout(playTimer);
        playTimer = null;
      }
    }

    function togglePlayback() {
      if (isPlaying) {
        stopPlayback();
        return;
      }
      isPlaying = true;
      playButton.classList.add("active");
      playButton.innerHTML =
        '<svg viewBox="0 0 20 20" aria-hidden="true"><path fill="currentColor" d="M5 4h3v12H5zm7 0h3v12h-3z"/></svg>Pause conversation';

      // Step 1: ensure we start from professor
      currentSpeaker = "professor";
      updateSpeakerDisplay();

      // Step 2: simulate “cut” to student after a delay
      playTimer = setTimeout(() => {
        currentSpeaker = "student";
        updateSpeakerDisplay();

        // Step 3: stop after student finishes
        playTimer = setTimeout(() => {
          stopPlayback();
        }, 7000);
      }, 7000);
    }

    profTab.addEventListener("click", () => {
      stopPlayback();
      currentSpeaker = "professor";
      updateSpeakerDisplay();
    });

    stuTab.addEventListener("click", () => {
      stopPlayback();
      currentSpeaker = "student";
      updateSpeakerDisplay();
    });

    playButton.addEventListener("click", togglePlayback);

    // INIT
    renderChapterButtons();
    setCurrentRecommendation(1);
  

// === v6: robust action handlers (safe even if elements don't exist) ===
(function(){
  function qAll(sel){ return Array.from(document.querySelectorAll(sel)); }
  function setAllDetails(open){
    qAll('details').forEach(d=>d.open = open);
  }
  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-action], #collapseAllBtn, #expandAllBtn, #toggleAllBtn');
    if(!btn) return;

    const action = btn.dataset.action || btn.id;
    if(action === 'collapseAllBtn' || action === 'collapse-all'){
      setAllDetails(false);
    } else if(action === 'expandAllBtn' || action === 'expand-all'){
      setAllDetails(true);
    } else if(action === 'toggleAllBtn' || action === 'toggle-all'){
      const anyClosed = qAll('details').some(d=>!d.open);
      setAllDetails(anyClosed);
    }
  }, {passive:true});
})();
